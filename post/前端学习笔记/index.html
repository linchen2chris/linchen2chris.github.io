<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>前端学习笔记 - Even - A super concise theme for Hugo</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="[Lin Chen]"><meta name=description content="React Native 前言: 最近独自上了一个纯前端 RN 的小项目, 项目没有后端, 前端用 RN 做原型, 这个项目后面还要用 RN 做一个大的项目, 所以趁这段时间, 学习整理下 RN 的入门知识, 主要针对从有 React 基础的人.
"><meta name=keywords content="Hugo,theme,even"><meta name=generator content="Hugo 0.157.0 with theme even"><link rel=canonical href=http://localhost:1313/post/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><link href=/sass/main.min.b0bb1cc82311612d45fc7e0aaa2c74271bfb5861a1fc871f6354b3ca11502ee4.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:url" content="http://localhost:1313/post/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="Even - A super concise theme for Hugo"><meta property="og:title" content="前端学习笔记"><meta property="og:description" content="React Native 前言: 最近独自上了一个纯前端 RN 的小项目, 项目没有后端, 前端用 RN 做原型, 这个项目后面还要用 RN 做一个大的项目, 所以趁这段时间, 学习整理下 RN 的入门知识, 主要针对从有 React 基础的人."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-24T17:12:05+08:00"><meta property="article:modified_time" content="2025-04-10T15:38:39+08:00"><meta property="article:tag" content="大前端"><meta itemprop=name content="前端学习笔记"><meta itemprop=description content="React Native 前言: 最近独自上了一个纯前端 RN 的小项目, 项目没有后端, 前端用 RN 做原型, 这个项目后面还要用 RN 做一个大的项目, 所以趁这段时间, 学习整理下 RN 的入门知识, 主要针对从有 React 基础的人."><meta itemprop=datePublished content="2021-05-24T17:12:05+08:00"><meta itemprop=dateModified content="2025-04-10T15:38:39+08:00"><meta itemprop=wordCount content="2231"><meta itemprop=keywords content="大前端"><meta name=twitter:card content="summary"><meta name=twitter:title content="前端学习笔记"><meta name=twitter:description content="React Native 前言: 最近独自上了一个纯前端 RN 的小项目, 项目没有后端, 前端用 RN 做原型, 这个项目后面还要用 RN 做一个大的项目, 所以趁这段时间, 学习整理下 RN 的入门知识, 主要针对从有 React 基础的人."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>Lin Chen</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/ox-hugo/><li class=mobile-menu-item>resource</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>Lin Chen</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/ox-hugo/>resource</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>前端学习笔记</h1><div class=post-meta><span class=post-time>2021-05-24 </span><span class=more-meta>2231 words </span><span class=more-meta>5 mins read </span><span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#react-native>React Native</a><ul><li></li></ul></li><li><a href=#flex>Flex</a><ul><li><a href=#container-上的>container 上的</a></li><li><a href=#item-上的>item 上的</a></li><li><a href=#flex-grow>flex-grow:</a></li><li><a href=#flex-shrink>flex-shrink:</a></li><li><a href=#flex-basis>flex-basis:</a></li><li><a href=#flex>flex</a></li></ul></li><li><a href=#typescript>typescript</a></li><li><a href=#jest>jest</a><ul><li><a href=#expect-断言>expect 断言</a></li><li><a href=#mock-stub-函数>mock stub 函数</a></li><li><a href=#api-cheetsheat>api cheetsheat</a></li><li><a href=#mock-function-api>mock function api</a></li><li><a href=#jest-api>jest API</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-outdated><div class=warn><p>[NOTE] Updated <span class=timeago datetime=2025-04-10T15:38:39 title="April 10, 2025">April 10, 2025</span>. This article may have outdated content or subject matter.</p></div></div><div class=post-content><h2 id=react-native>React Native</h2><p>前言: 最近独自上了一个纯前端 RN 的小项目, 项目没有后端, 前端用 RN 做原型, 这个项目后面还要用 RN 做一个大的项目, 所以趁这段时间, 学习整理下 RN 的入门知识, 主要针对从有 React 基础的人.</p><h4 id=react-navigator>React-navigator</h4><p>导航功能:
RN:Consider a stack navigator with screens A and B. After navigating to A, its componentDidMount is called. When pushing B, its componentDidMount is also called,
but A remains mounted on the stack and its componentWillUnmount is therefore not called.
RN forward 的时候等于 push, 不会 unmount stack 上个组件. 但 back 的时候等于 Pop 出去, 是会 unmount 上个的.</p><h4 id=stacknavigator>stackNavigator</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>			<span class=kr>export</span> <span class=kr>const</span> <span class=nx>stackNavigationOptions</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>headerBackTitle</span><span class=o>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>headerTintColor</span><span class=o>:</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>headerTitleStyle</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>fontWeight</span><span class=o>:</span> <span class=s1>&#39;bold&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=nx>fontSize</span><span class=o>:</span> <span class=mi>14</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=p>},</span>
</span></span><span class=line><span class=cl>			<span class=p>};</span>
</span></span><span class=line><span class=cl>			<span class=kr>const</span> <span class=nx>SampleStack</span> <span class=o>=</span> <span class=nx>createStackNavigator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>				<span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>SampleApplyPage</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>						<span class=nx>screen</span><span class=o>:</span> <span class=nx>WithSampleContext</span><span class=p>(</span><span class=nx>SampleApplyPage</span><span class=p>),</span>
</span></span><span class=line><span class=cl>						<span class=nx>navigationOptions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>							<span class=p>...</span><span class=nx>stackNavigationOptions</span><span class=p>,</span>
</span></span><span class=line><span class=cl>							<span class=nx>title</span><span class=o>:</span> <span class=s1>&#39;Urgent Sample&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>						<span class=p>},</span>
</span></span><span class=line><span class=cl>					<span class=p>},</span>
</span></span><span class=line><span class=cl>					<span class=nx>SampleConfirmationPage</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>						<span class=nx>screen</span><span class=o>:</span> <span class=nx>WithSampleContext</span><span class=p>(</span><span class=nx>SampleConfirmationPage</span><span class=p>),</span>
</span></span><span class=line><span class=cl>						<span class=nx>navigationOptions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>							<span class=p>...</span><span class=nx>stackNavigationOptions</span><span class=p>,</span>
</span></span><span class=line><span class=cl>							<span class=nx>title</span><span class=o>:</span> <span class=s1>&#39;Sample Confirmation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>						<span class=p>},</span>
</span></span><span class=line><span class=cl>					<span class=p>},</span>
</span></span><span class=line><span class=cl>				<span class=p>},</span>
</span></span><span class=line><span class=cl>				<span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>initialRouteName</span><span class=o>:</span> <span class=s1>&#39;SampleApplyPage&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=p>},</span>
</span></span><span class=line><span class=cl>			<span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=flex>Flex</h2><h3 id=container-上的>container 上的</h3><ul><li>flex-direction: row | row-reverse | column | column-reverse;</li><li>flex-wrap: nowrap | wrap | wrap-reverse;</li><li>flex-flow: flex-direction 属性和 flex-wrap 属性的简写形式，默认值为 row nowrap</li><li>justify-content: 属性定义了项目在主轴上的对齐方式: flex-start | flex-end | center | space-between | space-around</li></ul><figure><img src=/react-native%E5%85%A5%E9%97%A8.org_imgs/20190307_210937_IS44dQ.png></figure><ul><li>align-items: 属性定义项目在交叉轴上如何对齐</li></ul><figure><img src=/react-native%E5%85%A5%E9%97%A8.org_imgs/20190307_210959_1EInGg.png></figure><ul><li>align-content: 属性定义了多根轴线的对齐方式。如果项目只有一根轴线，该属性不起作用。</li></ul><figure><img src=/react-native%E5%85%A5%E9%97%A8.org_imgs/20190307_211020_dPDdd8.png></figure><h3 id=item-上的>item 上的</h3><ul><li>order</li><li>flex-grow</li><li>flex-shrink</li><li>flex-basis</li><li>flex</li><li>align-self: 属性允许单个项目有与其他项目不一样的对齐方式，可覆盖 align-items 属性。默认值为 auto，表示继承父元素的 align-items 属性，如果没有父元素，则等同于 stretch</li></ul><p>auto | flex-start | flex-end | center | baseline | stretch;</p><h3 id=flex-grow>flex-grow:</h3><p><code>flex-grow</code> 属性定义项目的放大比例，默认为 0，即如果存在剩余空间，也不放大。
如果所有项目的 <code>flex-grow</code> 属性都为 1，则它们将等分剩余空间（如果有的话）。如果一个项目的 <code>flex-grow</code> 属性为 2，其他项目都为 1，则前者占据的剩余空间将比其他项多一倍。</p><h3 id=flex-shrink>flex-shrink:</h3><p><code>flex-shrink</code> 属性定义了项目的缩小比例，默认为 1，即如果空间不足，该项目将缩小。
如果所有项目的 flex-shrink 属性都为 1，当空间不足时，都将等比例缩小。如果一个项目的 flex-shrink 属性为 0，其他项目都为 1，则空间不足时，前者不缩小。
负值对该属性无效。</p><h3 id=flex-basis>flex-basis:</h3><p><code>flex-basis</code> 属性定义了在分配多余空间之前，项目占据的主轴空间（main size）。浏览器根据这个属性，计算主轴是否有多余空间。它的默认值为 auto，即项目的本来大小。
它可以设为跟 width 或 height 属性一样的值（比如 350px），则项目将占据固定空间。</p><blockquote><p>auto：首先检索该子元素的主尺寸，如果主尺寸不为 auto，则使用值采取主尺寸之值；如果也是 auto，则使用值为 content。</p><p>content：指根据该子元素的内容自动布局。有的用户代理没有实现取 content 值，等效的替代方案是 flex-basis 和主尺寸都取 auto。</p><p>百分比：根据其包含块（即伸缩父容器）的主尺寸计算。如果包含块的主尺寸未定义（即父容器的主尺寸取决于子元素），则计算结果和设为 auto 一样。</p></blockquote><h3 id=flex>flex</h3><p>flex: 是 flex-grow、flex-shrink、flex-basis 的缩写. 默认值为 0 1 auto, 后两个属性可选。
该属性有两个快捷值：auto (1 1 auto) 和 none (0 0 auto)。
建议优先使用这个属性，而不是单独写三个分离的属性，因为浏览器会推算相关值。</p><ol><li>当 flex 取值为一个非负数字，则该数字为 flex-grow 值，flex-shrink 取 1(default)，flex-basis 取 0%.</li><li>当 flex 取值为一个长度或百分比，则视为 flex-basis 值，flex-grow 取 1，flex-shrink 取 1(default)</li><li>当 flex 取值为两个非负数字，则分别视为 flex-grow 和 flex-shrink 的值，flex-basis 取 0%</li><li>当 flex 取值为一个非负数字和一个长度或百分比，则分别视为 flex-grow 和 flex-basis 的值，flex-shrink 取 1(default)</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>     <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;parent&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;item-1&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;item-2&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;item-3&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>     <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl>     <span class=p>.</span><span class=nc>parent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=k>display</span><span class=p>:</span> <span class=kc>flex</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>width</span><span class=p>:</span> <span class=mi>600</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=p>.</span><span class=nc>parent</span> <span class=o>&gt;</span> <span class=nt>div</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=p>.</span><span class=nc>item-1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=k>width</span><span class=p>:</span> <span class=mi>140</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>flex</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>1</span> <span class=mi>0</span><span class=kt>%</span><span class=p>;</span> <span class=err>-&gt;</span> <span class=err>0%</span> <span class=k>width</span><span class=p>:</span> <span class=mi>140</span> <span class=err>就会无效</span>
</span></span><span class=line><span class=cl>                                      <span class=k>background</span><span class=o>:</span> <span class=kc>blue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=p>.</span><span class=nc>item-2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>flex</span><span class=p>:</span> <span class=mi>2</span> <span class=mi>1</span> <span class=kc>auto</span><span class=p>;</span> <span class=err>-&gt;</span> <span class=err>auto</span> <span class=err>width</span> <span class=err>就是</span> <span class=err>100px</span>
</span></span><span class=line><span class=cl>                       <span class=k>background</span><span class=p>:</span> <span class=kc>darkblue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=p>.</span><span class=nc>item-3</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=k>flex</span><span class=p>:</span> <span class=mi>1</span> <span class=mi>1</span> <span class=mi>200</span><span class=kt>px</span><span class=p>;</span> <span class=err>-&gt;</span> <span class=err>直接指定</span> <span class=err>width</span> <span class=err>就是</span> <span class=err>200px</span>
</span></span><span class=line><span class=cl>                        <span class=k>background</span><span class=p>:</span> <span class=kc>lightblue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>初始宽度是 0 + auto(100) + 200 = 300px 父级宽度是 600px 所以多了 300px, flex-grow 是 2+2+1 所以第份是 60px
item1-> 0+ 120
item2-> 100+120
item3-> 200+60</p><h2 id=typescript>typescript</h2><p>React 的类型:
React.ReactNode, React.ReactElement, React.CSSProperties,</p><h2 id=jest>jest</h2><h3 id=expect-断言>expect 断言</h3><ul><li>common<ol><li>toBe - toBe 使用 Object.is 来测试是否完全相等</li><li>not - 用来测试相反的用例</li><li>toEqual - 如果你想检查某个对象的值，请改用 toEqual</li><li>toStrictEqual - test that objects have the same types as well as structure.</li></ol></li></ul><ul><li><p>boolean</p><ol><li>toBeNull 只匹配 null</li><li>toBeUndefined</li><li>toBeDefined</li><li>toBeTruthy</li><li>toBeFalsy</li><li>toBeNaN</li></ol><ul><li>number<ol><li>toBeGreaterThan</li><li>toBeGreaterThanOrEqual</li><li>toBeLessThan</li><li>toBeLessThanOrEqual</li><li>toBeCloseTo</li></ol></li><li>regex<ol><li>toMatch</li></ol></li><li>array<ul><li>toHaveLength</li><li>toContain - 判断数组是否包含特定子项</li><li>toContainEqual - 判断数组中是否包含一个特定对象</li></ul></li><li>object<ol><li>toMatchObject(Obj) - 判断一个对象嵌套的 key 下面的 value 类型</li><li>toHaveProperty(keyPath, value) - 判断在指定的 path 下是否有这个属性</li></ol></li><li>customise<ol><li>expect.extend 将自己的匹配器添加到 Jest.自定义匹配器需要返回一个包含两个 key 的对象</li></ol></li><li>error<ol><li>toThrow - 要测试的特定函数会在调用时抛出一个错误</li><li>toThrowError</li></ol></li><li>promise<ol><li>resolves 和 rejects - 用来测试 promise</li></ol></li><li>snapshot<ol><li>toMatchSnapshot - snapshot test</li><li>toMatchInlineSnapshot</li><li>toThrowErrorMatchingSnapshot</li><li>toThrowErrorMatchingInlineSnapshot</li></ol></li><li>function<ol><li>toHaveBeenCalled - 用来判断一个函数是否被调用过</li><li>toHaveBeenCalledTimes - 判断函数被调用过几次</li><li>lastCalledWith</li><li>toBeCalledWith(arg1, arg2, &mldr;)</li><li>toHaveBeenCalledWith</li><li>toHaveBeenLastCalledWith</li><li>toHaveBeenNthCalledWith(arg1, arg2, &mldr;)</li><li>toHaveReturned() - mock function return, ie not throw error</li><li>toHaveReturnedTimes(number) - return times</li><li>toHaveReturnedWith(value)</li><li>toHaveLastReturnedWith(value)</li><li>toHaveNthReturnedWith(value)</li><li>toBeInstanceOf</li></ol></li><li>构造假对象<ol><li>expect.anything - expect.anything() matches anything but null or undefined</li><li>expect.any(constructor)</li><li>expect.arrayContaining(array) - 包含指定数组的任意数组.</li><li>expect.not.arrayContaining(array) - 不包含指定数组的任意数组</li><li>expect.assertions(number) - 验证有几个断言被执行了.</li><li>expect.hasAssertions() - 验证至少有一个断言被执行.</li><li>expect.stringContaining(string)</li><li>expect.stringMatching(string | regexp)</li><li>expect.addSnapshotSerializer() - 自定义序列化工具</li></ol></li></ul></li></ul><h3 id=mock-stub-函数>mock stub 函数</h3><p>如何 stub 一个函数?</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>      <span class=nx>jest</span><span class=p>.</span><span class=nx>spyOn</span><span class=p>(</span><span class=nb>Math</span><span class=p>,</span> <span class=s1>&#39;random&#39;</span><span class=p>).</span><span class=nx>mockImplementation</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>jest</span><span class=p>.</span><span class=nx>clearAllMocks</span><span class=p>();</span> <span class=c1>//clear 掉
</span></span></span></code></pre></td></tr></table></div></div><h3 id=api-cheetsheat>api cheetsheat</h3><ol><li><p>afterAll(fn, timeout)</p></li><li><p>afterEach</p></li><li><p>beforeAll</p></li><li><p>beforeEach</p></li><li><p>describe(.only | .skip), fdescribe, xdescribe</p></li><li><p>describe.each</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>         <span class=nx>describe</span><span class=p>.</span><span class=nx>each</span><span class=p>([[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>]])(</span>
</span></span><span class=line><span class=cl>           <span class=s1>&#39;.add(%i, %i)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=nx>test</span><span class=p>(</span><span class=sb>`returns </span><span class=si>${</span><span class=nx>expected</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>               <span class=nx>expect</span><span class=p>(</span><span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=nx>expected</span><span class=p>);</span>
</span></span><span class=line><span class=cl>             <span class=p>});</span>
</span></span><span class=line><span class=cl>           <span class=p>},</span>
</span></span><span class=line><span class=cl>         <span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>         <span class=nx>describe</span><span class=p>.</span><span class=nx>each</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>           a    | b    | expected
</span></span></span><span class=line><span class=cl><span class=sb>           </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>2</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>           </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>2</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>3</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>           </span><span class=si>${</span><span class=mi>2</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>3</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>         `</span><span class=p>(</span><span class=s1>&#39;returns $expected when $a is added $b&#39;</span><span class=p>,</span> <span class=p>({</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>expected</span><span class=p>})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=nx>test</span><span class=p>(</span><span class=s1>&#39;will be ran&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=nx>expect</span><span class=p>(</span><span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=nx>expected</span><span class=p>);</span>
</span></span><span class=line><span class=cl>           <span class=p>});</span>
</span></span><span class=line><span class=cl>         <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>test | it (.only |.skip) xtest xit ftest fit</p></li><li><p>it.each(table)(name, fn, timeout) => name 里</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>         <span class=nx>test</span><span class=p>.</span><span class=nx>each</span><span class=p>([[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>]])(</span>
</span></span><span class=line><span class=cl>           <span class=s1>&#39;.add(%i, %i)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=nx>expect</span><span class=p>(</span><span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=nx>expected</span><span class=p>);</span>
</span></span><span class=line><span class=cl>           <span class=p>},</span>
</span></span><span class=line><span class=cl>         <span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>test.each`table`(name, fn, timeout)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>         <span class=nx>test</span><span class=p>.</span><span class=nx>each</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>           a    | b    | expected
</span></span></span><span class=line><span class=cl><span class=sb>           </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>2</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>           </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>2</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>3</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>           </span><span class=si>${</span><span class=mi>2</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>1</span><span class=si>}</span><span class=sb> | </span><span class=si>${</span><span class=mi>3</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>         `</span><span class=p>(</span><span class=s1>&#39;returns $expected when $a is added $b&#39;</span><span class=p>,</span> <span class=p>({</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>expected</span><span class=p>})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=nx>expect</span><span class=p>(</span><span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=nx>expected</span><span class=p>);</span>
</span></span><span class=line><span class=cl>         <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=mock-function-api>mock function api</h3><p>mock function: jest.fn() 就会返回一个 mock function, 默认返回 undefined.
<img src=/react-native%E5%85%A5%E9%97%A8.org_imgs/20190319_105552_yqdvHN.png alt></p><ul><li>mockClear: Resets all information stored in the mockFn.mock.calls and mockFn.mock.instances arrays.</li><li>mockReset: mockFn.mockClear() + removes any mocked return values or implementations.</li><li>mockRestore: mockFn.mockReset() + restores the original (non-mocked) implementation.</li></ul><h3 id=jest-api>jest API</h3><ul><li><p>genMockFromModule => 相当于 enableAutomock, 然后你可以再自定义一个自己的 mock</p></li><li><p>jest.mock(moduleName, factory?, options?) => doMock() :
mock 在 Babel-jest 中有问题, doMock 为了解决这个问题.
When using babel-jest, calls to mock will automatically be hoisted to the top of the code block. Use this method if you want to explicitly avoid this behavior.</p></li><li><p>unmock => dontMock 同理.</p></li><li><p>requireActual 和 requireMock, 如果一个 module 中有多个 export, 可以用这个来表明你想用的是 mock 的还是真实的.</p></li><li><p>spyOn: 不仅像fn一样创建一个mock fn, 还会 tracks calls to object[methodName].</p></li><li><p>clearAllMocks() = mockClear()</p></li><li><p>resetAllMocks = mockReset</p></li></ul><p>timer 是给setTimeout, setInterval, clearTimeout, clearInterval, nextTick, setImmediate and clearImmediate这些fn用的.</p></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>[Lin Chen]</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2025-04-10</span></p></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>Reward</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=/wechat.JPG>
<span>wechat</span>
</label><label class=qr-code-image for=reward><img class=image src=/alipay.JPG>
<span>alipay</span></label></div></div><footer class=post-footer><div class=post-tags><a href=/tags/%E5%A4%A7%E5%89%8D%E7%AB%AF/>大前端</a></div><nav class=post-nav><a class=prev href=/post/fp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">FP 学习笔记(基于 JS)</span>
<span class="prev-text nav-mobile">Prev</span></a></nav></footer></article></div><div id=gitalk-container></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js crossorigin=anonymous></script><script type=text/javascript>var gitalk=new Gitalk({id:"2021-05-24 17:12:05 +0800 +0800",title:"前端学习笔记",clientID:"5cbf8030e176bc7021bc",clientSecret:"c1a85771c8ef436e35a28f16a94de527e8a60820",repo:"linchen2chris.github.io",owner:"linchen2chris",admin:["linchen2chris"],body:decodeURI(location.href)});gitalk.render("gitalk-container")</script><noscript>Please enable JavaScript to view the <a href=https://github.com/gitalk/gitalk>comments powered by gitalk.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:lc1990linux@gmail.com class="iconfont icon-email" title=email></a><a href=https://stackoverflow.com/users/2009613/user2009613 class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://twitter.com/chris_linchen class="iconfont icon-twitter" title=twitter></a><a href=https://www.facebook.com/chris.linchen.1 class="iconfont icon-facebook" title=facebook></a><a href=https://www.linkedin.com/in/chen-lin-945609a1/ class="iconfont icon-linkedin" title=linkedin></a><a href=http://localhost:1313 class="iconfont icon-google" title=google></a><a href=https://github.com/linchen2chris class="iconfont icon-github" title=github></a><a href=http://localhost:1313 class="iconfont icon-weibo" title=weibo></a><a href=https://www.zhihu.com/people/lin-chen-73-53 class="iconfont icon-zhihu" title=zhihu></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span><span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> </span><span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
2016 -
2026<span class=heart><i class="iconfont icon-heart"></i></span><span></span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin=anonymous></script><script>var languageCode="en".replace(/-/g,"_").replace(/_(.*)/,function(e,t){return e.replace(t,t.toUpperCase())});timeago().render(document.querySelectorAll(".timeago"),languageCode),timeago.cancel()</script><script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script><script type=text/javascript>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script></body></html>